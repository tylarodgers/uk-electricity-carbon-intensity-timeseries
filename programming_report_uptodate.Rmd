---
title: "Renewable Electricity and Carbon Intensity in the UK"
author: '100428943'
date: "2025-12-22"
output: pdf
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)

library(tidyverse)
library(broom)
library(knitr)

# Helper: compact regression tables for reporting
compact_tidy <- function(model, keep_terms = NULL) {
  out <- broom::tidy(model)
  if (!is.null(keep_terms)) out <- dplyr::filter(out, term %in% keep_terms)
  out
}

compact_glance <- function(model) {
  broom::glance(model) %>%
    dplyr::select(nobs, r.squared, adj.r.squared)
}

```

## Introduction
The decarbonisation of electricity generation is a central component of the United Kingdom’s transition towards a low-carbon economy. Over the past two decades, the UK has experienced a substantial expansion in renewable electricity generation alongside a marked decline in the carbon intensity of its power grid. Understanding the relationship between these developments is important for evaluating the role of renewable energy in reducing emissions from the electricity sector. This project examines whether increases in renewable electricity generation are associated with measurable reductions in the carbon intensity of electricity generation in the United Kingdom.

Using annual time-series data covering the period 2000–2024, the analysis combines information on the UK’s electricity generation mix with data on electricity-sector carbon intensity obtained from Our World in Data (Ritchie, Roser and Rosado, 2024). The empirical approach proceeds in three stages. First, renewable electricity shares are constructed from disaggregated generation data by source. Second, descriptive analysis is used to document trends in renewable deployment and carbon intensity over time. Finally, regression analysis is employed to assess the relationship between renewable electricity shares and carbon intensity, alongside a set of robustness and diagnostic checks..

## Data and Variable Construction

This analysis draws on two datasets obtained from Our World in Data (Ritchie, Roser and Rosado, 2024). The first dataset provides annual measures of the carbon intensity of electricity generation, expressed in grams of CO₂ per kilowatt-hour. The second dataset contains annual electricity generation in the United Kingdom disaggregated by source, including wind, solar, hydropower, fossil fuels, nuclear energy, and net electricity imports.

The electricity generation dataset is restricted to observations for the United Kingdom and is used to construct a measure of renewable electricity generation. Consistent with the categorisation used in Our World in Data, renewable generation is defined as the sum of electricity generated from wind, solar, hydropower, and other renewable sources (Ritchie, Roser and Rosado, 2024). Total electricity generation is calculated as the sum of renewable generation, fossil fuel generation, nuclear generation, and net electricity imports. The renewable share of electricity generation is then defined as renewable generation divided by total generation.

The carbon intensity dataset is similarly restricted to UK observations and merged with the electricity generation data by year. As carbon intensity data are available from 2000 onwards, the final analysis sample covers the period 2000–2024. Observations with missing values are removed prior to analysis.

```{r data-cleaning, include=FALSE}

carbon_raw <- read_csv("carbon-intensity-electricity.csv")
electricity_raw <- read_csv("electricity-mix-uk.csv")
carbon_uk <- carbon_raw %>%
  filter(Entity == "United Kingdom") %>%
  select(
    year = Year,
    carbon_intensity = `Carbon intensity of electricity - gCO2/kWh`
  )

electricity_uk <- electricity_raw %>%
  filter(Entity == "United Kingdom") %>%
  select(
    year = Year,
    wind = `Electricity generation from wind`,
    solar = `Electricity generation from solar`,
    hydro = `Electricity generation from hydropower`,
    other_renewables = `Electricity generation from other renewables`,
    gas = `Electricity generation from gas`,
    coal = `Electricity generation from coal`,
    oil = `Electricity generation from oil`,
    nuclear = `Electricity generation from nuclear`,
    net_imports = `Net electricity imports`
  )

electricity_uk <- electricity_uk %>%
  mutate(
    renewable_generation = wind + solar + hydro + other_renewables,
    total_generation = renewable_generation + gas + coal + oil + nuclear + net_imports,
    renewable_share = renewable_generation / total_generation
  )
  
glimpse(electricity_uk)
summary(electricity_uk$renewable_share)

analysis_data <- left_join(
  electricity_uk,
  carbon_uk,
  by = "year"
)
glimpse(analysis_data)

summary(analysis_data$carbon_intensity)

sum(is.na(analysis_data$carbon_intensity))

analysis_data_clean <- analysis_data %>%
  filter(!is.na(carbon_intensity)) %>%
  select(
    year,
    renewable_share,
    carbon_intensity
  )

glimpse(analysis_data_clean)
range(analysis_data_clean$year)


```

```{r key-variable-construction, echo=TRUE, eval=FALSE}
# Key construction steps (illustrative)
# 1) Filter UK observations
# 2) Construct renewable_generation = wind + solar + hydro + other renewables
# 3) Compute renewable_share = renewable_generation / total_generation
# 4) Merge with carbon intensity by year

analysis_data_clean <- electricity_uk %>%
  dplyr::select(year, renewable_share) %>%
  dplyr::left_join(carbon_uk, by = "year")
```

## Descriptive Analysis

This section provides a descriptive overview of trends in renewable electricity generation and carbon intensity in the United Kingdom. Examining these trends over time helps to establish whether changes in the electricity generation mix coincide with changes in carbon intensity, prior to formal regression analysis.

```{r renewable-share-plot}
ggplot(analysis_data_clean, aes(x = year, y = renewable_share)) +
  geom_line(color = "darkgreen", linewidth = 1) +
  labs(
    title = "Renewable Share of Electricity Generation in the UK",
    x = "Year",
    y = "Renewable share"
  ) +
  theme_minimal()
```

Figure 1 shows a pronounced upward trend in the share of electricity generated from renewable sources over the sample period. Renewable penetration remains very low in the early 2000s but increases rapidly from the mid-2000s onwards, reflecting the expansion of wind and solar generation in the UK. By the end of the sample period, renewable electricity accounts for a substantial proportion of total generation.

```{r carbon-intensity-plot, echo=FALSE}
ggplot(analysis_data_clean, aes(x = year, y = carbon_intensity)) +
  geom_line(linewidth = 1) +
  labs(
    title = "Carbon Intensity of UK Electricity Generation (gCO2/kWh)",
    x = "Year",
    y = "Carbon intensity (gCO2/kWh)"
  ) +
  theme_minimal()
```

Figure 2 plots the carbon intensity of UK electricity generation from 2000–2024. Carbon intensity trends downward over the sample, indicating a sustained reduction in emissions per unit of electricity generated. This pattern is consistent with the UK’s shift away from coal and towards lower-carbon sources, and provides a visual benchmark for the regression relationship tested later.

```{r dual-axis-plot, echo=FALSE}
analysis_data_clean <- analysis_data_clean %>%
  mutate(
    carbon_intensity_scaled = carbon_intensity / max(carbon_intensity)
  )

ggplot(analysis_data_clean, aes(x = year)) +
  geom_line(aes(y = renewable_share, colour = "Renewable share"), linewidth = 1) +
  geom_line(
    aes(y = carbon_intensity / max(carbon_intensity), colour = "Carbon intensity (scaled)"),
    linewidth = 1
  ) +
  labs(
    title = "Renewable Share and Carbon Intensity in the UK",
    x = "Year",
    y = "Scaled values",
    colour = ""
  ) +
  theme_minimal()
```

Figure 3  plots the UK’s renewable share of electricity generation alongside carbon intensity over time. Since the two series are measured in different units, carbon intensity is linearly rescaled to lie between 0 and 1, allowing both variables to be visualised on the same axis without affecting their underlying time-series patterns.

The figure reveals a clear inverse relationship. From the early 2000s onward, the renewable share increases steadily, accelerating markedly after 2010. Over the same period, carbon intensity declines sharply, particularly during the mid-2010s, coinciding with rapid expansion of renewable generation and the phase-out of coal-fired electricity. While both series exhibit strong time trends, their opposing movements suggest a negative association between renewable penetration and the carbon intensity of electricity generation.

This visual evidence provides preliminary support for the hypothesis that increases in renewable electricity generation are associated with reductions in carbon intensity. However, as both variables trend over time, this descriptive analysis alone is insufficient to establish the strength or robustness of the relationship. The next section therefore formalises this association using regression analysis.

## Relationship Analysis

### Baseline: longrun association (levels)

I begin with a baseline levels regression that describes the long-run association between the UK’s renewable electricity share (measured as a proportion) and the carbon intensity of electricity generation (gCO₂/kWh). This specification captures how carbon intensity co-moves with the electricity generation mix over the sample period, but on its own it does not distinguish this relationship from broader underlying time trends.

```{r levels-regression, echo=TRUE}
levels_model <- lm(
  carbon_intensity ~ renewable_share,
  data = analysis_data_clean
)
```

```{r levels-regression-results}
compact_tidy(levels_model) %>%
  dplyr::select(term, estimate, std.error, statistic, p.value) %>%
  knitr::kable(
    digits = 3,
    caption = "Baseline levels regression: carbon intensity on renewable share"
  )

compact_glance(levels_model) %>%
  knitr::kable(
    digits = 3,
    caption = "Model fit statistics (baseline levels regression)"
  )
```

In the baseline levels model, the coefficient on renewable_share is negative and statistically significant (β = −813.155, p < 0.001), indicating that higher renewable shares are associated with lower carbon intensity. Because renewable_share is measured as a proportion, a 1 percentage point increase (0.01) is associated with an average reduction of approximately 8.13 gCO₂/kWh (0.01 × 813.155). The model fit is high (R² = 0.954), but this should be interpreted cautiously in a trending time-series context, as part of the strong fit may reflect shared time trends rather than a stable structural relationship.

### Robustness check 1: levels model with explicit time control

To reduce the risk that the baseline association is driven primarily by shared trends over time, I introduce an explicit time control using year. The purpose is not to interpret the year coefficient causally, but to absorb broad time varying influences such as policy changes, technological progress, and fuel-market conditions and to assess whether the renewables coefficient remains negative once common trends are accounted for.

```{r levels-with-trend, echo=TRUE}
levels_time_model <- lm(
  carbon_intensity ~ renewable_share + year,
  data = analysis_data_clean
)
```

```{r levels-with-trend-results}
compact_tidy(levels_time_model) %>%
  dplyr::select(term, estimate, std.error, statistic, p.value) %>%
  knitr::kable(
    digits = 3,
    caption = "Levels regression with time control (year)"
  )

compact_glance(levels_time_model) %>%
  knitr::kable(
    digits = 3,
    caption = "Model fit statistics (levels + year)"
  )
```

After controlling for year, the coefficient on renewable share remains negative and statistically significant (β = −1079.982, p < 0.001). Interpreted in percentage points, a 1pp increase in renewables is associated with an average reduction of approximately 10.80 gCO₂/kWh (0.01 × 1079.982). The change in magnitude relative to the baseline is consistent with both renewables and carbon intensity trending over time. Accordingly, year is treated as a trend control rather than given a structural interpretation; the key result is that the renewables carbon intensity relationship remains strongly negative after accounting for common time trends.

### Robustness check 2: short-run dynamics (first differences)

Next, I estimate the relationship in first differences to focus on year to year changes rather than long run comovement in levels. Differencing reduces the influence of slow-moving trends and helps assess whether annual increases in renewables are associated with contemporaneous annual reductions in carbon intensity.

```{r first-differences-regression, echo=TRUE}
diff_data <- analysis_data_clean %>%
  arrange(year) %>%
  mutate(
    d_carbon = carbon_intensity - lag(carbon_intensity),
    d_renewable = renewable_share - lag(renewable_share)
  ) %>%
  filter(!is.na(d_carbon))

diff_model <- lm(d_carbon ~ d_renewable, data = diff_data)
```

```{r first-differences-results}
compact_tidy(diff_model) %>%
  dplyr::select(term, estimate, std.error, statistic, p.value) %>%
  knitr::kable(
    digits = 3,
    caption = "First-differences regression: Δ carbon intensity on Δ renewable share"
  )

compact_glance(diff_model) %>%
  knitr::kable(
    digits = 3,
    caption = "Model fit statistics (first differences)"
  )
```

In the differenced specification, changes in renewable share are negatively and statistically significantly associated with changes in carbon intensity (β = −622.666, p = 0.008). Because renewable_share is measured as a proportion, a 1pp increase (0.01) is associated with an average reduction of approximately 6.23 gCO₂/kWh (0.01 × 622.666). Explanatory power is lower (R² = 0.278), which is expected in first differences, as short-run annual movements are influenced by transitory factors such as weather conditions, demand variation, and fuel prices, in addition to longer-run structural change.

### Robustness check 3: mechanism test (coal displacement)

Finally, I extend the levels specification by controlling for coal’s share of total generation. This provides a mechanism consistent check: if renewables are associated with lower carbon intensity partly through the displacement of coal generation, then (i) coal_share should be strongly positively associated with carbon intensity, and (ii) the magnitude of the renewables coefficient should attenuate once coal share is included.
```{r coal-extended-regression, echo=TRUE}
analysis_data_coal <- analysis_data_clean %>%
  left_join(
    electricity_uk %>% select(year, coal, total_generation),
    by = "year"
  ) %>%
  mutate(
    coal_share = coal / total_generation
  )

coal_model <- lm(
  carbon_intensity ~ renewable_share + coal_share,
  data = analysis_data_coal
)
```

```{r coal-extended-results}
compact_tidy(coal_model, keep_terms = c("(Intercept)", "renewable_share", "coal_share")) %>%
  dplyr::select(term, estimate, std.error, statistic, p.value) %>%
  knitr::kable(
    digits = 3,
    caption = "Mechanism check: renewables and coal share (levels)"
  )

compact_glance(coal_model) %>%
  knitr::kable(
    digits = 3,
    caption = "Model fit statistics (levels + coal share)"
  )
```

Controlling for coal’s share of electricity generation supports the coal-displacement mechanism. coal_share is strongly and positively associated with carbon intensity (β = 533.191, p < 0.001), meaning that a 10pp higher coal share is associated with roughly +53.3 gCO₂/kWh higher carbon intensity (0.10 × 533.191). The renewables coefficient remains negative and statistically significant (β = −347.836, p < 0.001), but its magnitude is smaller than in the simpler levels models; in percentage-point terms, a 1pp increase in renewables is associated with about −3.48 gCO₂/kWh (0.01 × 347.836) holding coal share constant. This pattern is consistent with the idea that part of the renewables–carbon relationship operates through contemporaneous fuel-mix changes, especially coal displacement.


### Extension: heterogeneity via interaction (renewables × coal)

To test whether the relationship between renewable share and carbon intensity varies with how coal-intensive the electricity system is, I extend the coal mechanism model by including an interaction between renewable_share and coal_share, while also controlling for year. With an interaction, the marginal effect of renewable share on carbon intensity is given by the coefficient on renewable_share plus the interaction coefficient multiplied by coal_share. A negative interaction term therefore implies that the emissions benefit of renewables becomes larger in magnitude when coal’s share is higher, which is consistent with the idea that renewables deliver greater reductions when they are more likely to displace coal generation.

```{r interaction-model, echo=TRUE}
interaction_model <- lm(
  carbon_intensity ~ renewable_share * coal_share + year,
  data = analysis_data_coal
)
```

```{r interaction-model-results}
compact_tidy(interaction_model,
             keep_terms = c("(Intercept)", "renewable_share", "coal_share", "year", "renewable_share:coal_share")) %>%
  dplyr::select(term, estimate, std.error, statistic, p.value) %>%
  knitr::kable(
    digits = 3,
    caption = "Interaction model: renewables × coal share (with year control)"
  )

compact_glance(interaction_model) %>%
  knitr::kable(
    digits = 3,
    caption = "Model fit statistics (interaction model)"
  )
```

The interaction term is negative and statistically significant (β = −584.88, p = 0.015), implying that the marginal association between renewables and carbon intensity becomes more negative when coal’s share is higher. Coal share remains strongly positively associated with carbon intensity (β = 577.90, p < 0.001). Consistent with this, Figure 4 shows steeper predicted declines in carbon intensity with renewables under higher coal-share scenarios, supporting the interpretation that renewable expansion delivers larger emissions benefits when the system is more coal-intensive (i.e., when coal displacement is more likely).

```{r interaction-coefs, include=FALSE}
# (Removed from main text to reduce repetition/word count)
```

To make the interaction easier to interpret visually, I plot predicted carbon intensity against renewable share for three representative coal share scenarios (low / median / high coal share). This figure is descriptive: it translates the fitted linear model into implied relationships across plausible values.

```{r interaction-plot, echo=FALSE}
library(dplyr)
library(tidyr)
library(ggplot2)

coal_q <- quantile(analysis_data_coal$coal_share, probs = c(0.25, 0.50, 0.75), na.rm = TRUE)
names(coal_q) <- c("Low coal (25th pct)", "Median coal (50th pct)", "High coal (75th pct)")

pred_grid <- expand_grid(
  renewable_share = seq(min(analysis_data_coal$renewable_share, na.rm = TRUE),
                        max(analysis_data_coal$renewable_share, na.rm = TRUE),
                        length.out = 100),
  coal_share = as.numeric(coal_q),
  year = median(analysis_data_coal$year, na.rm = TRUE)
) %>%
  mutate(
  coal_scenario = factor(coal_share,
    labels = c("Low coal (25th pct)", "Median coal (50th pct)", "High coal (75th pct)")
  ),
  fitted = predict(interaction_model, newdata = .)
)
ggplot(pred_grid, aes(x = renewable_share, y = fitted, linetype = coal_scenario)) +
  geom_line(linewidth = 1) +
  labs(
    title = "Predicted carbon intensity vs renewables (by coal-share scenario)",
    x = "Renewable share (%)",
    y = "Predicted carbon intensity"
  )
```

When interpreting Figure 4, the key feature is the difference in slopes across coal-share scenarios. The steeper downward slope under higher coal shares indicates that expansions in renewable generation are associated with larger reductions in carbon intensity when the electricity system is more coal-intensive.

### Extension: non-linear relationship (quadratic specification)

It is plausible that the relationship between renewable deployment and carbon intensity is non-linear. Early renewable expansion may displace particularly carbon intensive generation, while later expansion could yield diminishing marginal reductions as the grid becomes cleaner. To test this, I estimate a quadratic specification in renewable_share while retaining the year control to absorb common time trends.


```{r nonlinear-model, echo=TRUE}
nonlinear_model <- lm(
  carbon_intensity ~ renewable_share + I(renewable_share^2) + year,
  data = analysis_data_clean
)
```

In the quadratic model, the linear renewable term is negative and statistically significant (β = −1620.913, p < 0.001) while the squared term is positive and statistically significant (β = 838.350, p = 0.041), implying a downward-sloping relationship that flattens as renewable share rises (diminishing marginal reductions). The implied turning point is around R*≈0.97 (97% renewables), which lies well beyond the observed renewable shares in this sample, so the fitted relationship remains decreasing over the data range. Figure 5 visualises this pattern: carbon intensity falls as renewables rise, but the curve becomes less steep at higher renewable penetration.



```{r nonlinear-coefs, echo=FALSE}
broom::tidy(nonlinear_model) %>%
  select(term, estimate, std.error, statistic, p.value) %>%
  knitr::kable(digits = 3, caption = "Quadratic model coefficients (non-linear renewables effect, with year control)")
```

To visualise the implied non-linear relationship, I plot the fitted quadratic curve over the observed data.This helps communicate the shape implied by the model.

```{r nonlinear-plot, echo=FALSE}
pred_curve <- tibble(
  renewable_share = seq(min(analysis_data_clean$renewable_share, na.rm = TRUE),
                        max(analysis_data_clean$renewable_share, na.rm = TRUE),
                        length.out = 200),
  year = median(analysis_data_clean$year, na.rm = TRUE)
) %>%
  mutate(fitted = predict(nonlinear_model, newdata = .))

ggplot(analysis_data_clean, aes(x = renewable_share, y = carbon_intensity)) +
  geom_point() +
  geom_line(data = pred_curve, aes(x = renewable_share, y = fitted), linewidth = 1) +
  labs(
    title = "Observed carbon intensity and fitted quadratic relationship",
    x = "Renewable share",
    y = "Carbon intensity"
  )
```

Figure 5 illustrates the fitted quadratic relationship between renewable share and carbon intensity. The downward sloping but flattening curve is consistent with diminishing marginal emissions reductions as renewable penetration rises, aligning with the positive squared term in the regression. While the linear specification captures the dominant trend, the quadratic model provides evidence that marginal effects weaken at higher renewable shares, serving as a robustness check on functional form rather than a substantive alternative.

Overall, allowing for non-linearity does not overturn the core finding: higher renewable shares remain strongly associated with lower carbon intensity. However, the quadratic fit (Figure 5) suggests that the marginal emissions benefit may weaken at higher renewable penetration, which is consistent with the system becoming cleaner over time. Together with the interaction evidence (Figure 4), this motivates checking how the estimated renewables coefficient changes as additional controls are introduced in the levels specifications below


### Comparing coefficients across levels specifications

To make the model-nesting logic transparent, I compare the estimated renewable_share coefficient across three levels-based specifications: (i) the baseline levels model, (ii) the levels model with a time control (year), and (iii) the coal-augmented model that isolates the fuel-mix channel. This summary shows how the magnitude of the renewables coefficient changes as additional controls are introduced.

```{r levels-comparison-table, echo=FALSE}
levels_compare <- list(
  "Levels" = levels_model,
  "Levels + year" = levels_time_model,
  "Levels + coal" = coal_model
)

bind_rows(lapply(names(levels_compare), function(nm) {
  broom::tidy(levels_compare[[nm]]) %>% mutate(model = nm)
})) %>%
  filter(term %in% c("renewable_share", "year", "coal_share")) %>%
  select(model, term, estimate, std.error, statistic, p.value) %>%
  knitr::kable(digits = 3, caption = "Coefficient comparison across levels specifications")
```
The table shows that the renewables coefficient is negative in all three levels specifications, but its magnitude varies with controls. The baseline estimate (−813.155) corresponds to about −8.13 gCO₂/kWh per 1pp increase in renewables, while adding the time control yields a larger magnitude (−1079.982 ≈ −10.80 per 1pp), consistent with trending behaviour affecting the raw relationship. Once coal share is included, the renewables coefficient shrinks to −347.836 (≈ −3.48 per 1pp) and coal share enters strongly positively (533.191), consistent with coal displacement accounting for an important part of the renewables–carbon intensity relationship.


Overall, the results across specifications provide consistent evidence that higher renewable electricity shares are associated with lower UK electricity carbon intensity. In the baseline levels model, the estimated long-run association is large and highly statistically significant (β̂ = −813.2, p < 0.001; R² = 0.954), but—because both series trend over time—this fit could partly reflect common time trends. Adding an explicit time control confirms the negative renewables relationship remains even after accounting for secular decarbonisation: the renewable coefficient stays negative and significant (β̂ = −1080.0, p < 0.001), alongside a positive year coefficient (β̂ = 5.88, p = 0.023; R² = 0.964). Focusing on short-run dynamics via first differences also supports the relationship: year-to-year changes in renewables are significantly associated with year-to-year changes in carbon intensity (β̂ = −622.7, p = 0.008; R² = 0.278), implying that a 1 percentage point increase in renewable share is associated with an average reduction of around 6.2 gCO₂/kWh.

Mechanism based models strengthen the interpretation that renewables reduce carbon intensity primarily through coal displacement. When coal share is included, coal share is strongly positively associated with carbon intensity (β̂ = 533.2, p < 0.001), while the renewable coefficient remains negative but shrinks substantially (β̂ = −347.8, p < 0.001; R² = 0.992), consistent with renewables operating partly by reducing coal generation. The interaction model reinforces this channel: the renewables × coal share term is negative and statistically significant (β̂ = −584.9, p = 0.015), indicating that the marginal emissions benefit of renewables is larger when coal’s role in the mix is higher, which is also visualised in Figure 4 through the steeper predicted decline under high-coal scenarios (R² = 0.996).

Allowing for non-linearity does not overturn the headline result, but suggests diminishing marginal benefits as renewable penetration increases. In the quadratic specification, the linear renewables term remains negative and significant (β̂ = −1620.9, p < 0.001) while the squared term is positive and significant (β̂ = 838.4, p = 0.041), implying a downward-sloping but flattening relationship, as shown in Figure 5 (R² = 0.970). Taken together, the consistent negative sign and statistical significance of renewables across levels, trend-controlled, differenced, mechanism, interaction, and quadratic models indicates a robust association between renewable expansion and lower carbon intensity, with the strongest evidence pointing to coal displacement as the primary transmission channel.

## Predictions and Residuals

After estimating the relationship between renewable generation and carbon intensity, I next evaluate how well the preferred specification fits the data. This section uses predicted values and residuals to check whether the model captures the main movements in carbon intensity over time, and to identify any years where actual outcomes deviate substantially from what the model would predict. Examining residual patterns is also useful for diagnosing potential misspecification (e.g., non-linearity, changing variance, or omitted shocks) and for motivating any further robustness checks.

```{r predicted-values, include=FALSE}
analysis_data_clean <- analysis_data_clean %>%
  mutate(
    predicted_carbon = predict(levels_time_model),
    residual = carbon_intensity - predicted_carbon
  )

```


```{r predicted-preview-table, echo=FALSE}
analysis_data_clean %>%
  select(year, renewable_share, carbon_intensity, predicted_carbon, residual) %>%
  slice_head(n = 6) %>%
  knitr::kable(
    digits = 3,
    caption = "Observed and predicted carbon intensity and residuals (first 6 years, levels + year model)"
  )
```

The table confirms how residuals are constructed:residual = actual carbon intensity − predicted carbon intensity. Positive residuals indicate under-prediction (actual > predicted), while negative residuals indicate over prediction. The remaining figures use these residuals to assess whether the model errors are mostly noise or display systematic structure.

```{r residuals-plot}
ggplot(analysis_data_clean, aes(x = year, y = residual)) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "grey40") +
  geom_line(color = "steelblue", linewidth = 1) +
  labs(
    title = "Regression Residuals Over Time Plot",
    x = "Year",
    y = "Residual (gCO₂/kWh)"
  ) +
  theme_minimal()
```

The residual series, figure 6, (from the levels + year model) shows that even after controlling for renewable share and an explicit time trend there are periods where the model persistently over or under-predicts carbon intensity. This is consistent with omitted time-varying influences such as shifts in relative fuel prices, policy changes affecting dispatch, outages, and weather-driven demand. The residual patterns therefore reinforce that the regression is best interpreted as a descriptive association, and that year specific shocks can still matter even after accounting for renewables and a linear trend.

In the early 2000s, residuals are generally close to zero (with occasional modest negatives), suggesting the fitted relationship captures average outcomes reasonably well in that period. Larger deviations appear later in the sample. The largest under-prediction occurs in 2012 (residual ≈ +35.2 gCO₂/kWh), while the strongest over-prediction occurs in 2016 (residual ≈ −59.5 gCO₂/kWh), implying carbon intensity fell more sharply than the model predicts in 2016 given renewable share and the linear trend alone. These episodes are consistent with additional structural or shock-driven factors affecting the generation mix and emissions intensity beyond the included regressors

```{r residuals-vs-fitted}
ggplot(analysis_data_clean, aes(x = predicted_carbon, y = residual)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(
    title = "Residuals vs Fitted Values Plot",
    x = "Predicted carbon intensity (gCO₂/kWh)",
    y = "Residual (actual − predicted)"
  ) +
  theme_minimal()
```

```{r residual-summary-and-outliers, include=FALSE}
resid_summary <- analysis_data_clean %>%
  summarise(
    mean_resid = mean(residual, na.rm = TRUE),
    sd_resid   = sd(residual, na.rm = TRUE),
    p10 = quantile(residual, 0.10, na.rm = TRUE),
    p50 = quantile(residual, 0.50, na.rm = TRUE),
    p90 = quantile(residual, 0.90, na.rm = TRUE)
  )

resid_outliers <- analysis_data_clean %>%
  mutate(abs_resid = abs(residual)) %>%
  arrange(desc(abs_resid)) %>%
  slice_head(n = 5) %>%
  select(year, renewable_share, carbon_intensity, predicted_carbon, residual)
```


Figure 7 plots residuals against fitted values to check for functional form problems and changing variance. A clear curve would suggest non-linearity not captured by the model, while a funnel shape would indicate heteroskedasticity (error variance changing with the fitted level of carbon intensity). Any remaining structure should therefore be interpreted as evidence of potential misspecification and/or omitted time-varying influences (e.g., fuel-market conditions, outages, weather-driven demand, imports, or policy-related changes) beyond renewable share and a linear trend.

Additional diagnostic detail is provided in Appendix Figure 8, which visualises residuals as vertical segments between observed and fitted carbon intensity.


## Discussion and Limitations

### Discussion

The descriptive evidence (Figures 1–3) shows a pronounced rise in renewable electricity share alongside a substantial decline in carbon intensity over the sample. The baseline levels regression formalises this long-run relationship: renewable share is strongly negatively associated with carbon intensity (β = −813.155, p < 0.001), implying that a 1 percentage point (pp) increase in renewable share (0.01) corresponds to an average reduction of about 8.13 gCO₂/kWh. The model fit is high (R² = 0.954), which is consistent with a strong long-run co-movement between the two series.

Introducing an explicit time control is an important robustness step given the shared time trends in both variables. In the levels + year model, the renewable coefficient remains strongly negative (β = −1079.982, p < 0.001), corresponding to about 10.80 gCO₂/kWh lower carbon intensity for a 1pp increase in renewable share. The year coefficient is positive (β̂ = 5.88, p = 0.023), and overall fit remains high (R² = 0.964). The key interpretive point is not the year coefficient itself, but that renewables remain negatively associated with carbon intensity even after absorbing a linear time trend.

To focus on short-run co-movement rather than long-run levels, the first-differences specification examines annual changes. The differenced model still shows a negative and statistically significant relationship (β = −622.666, p = 0.008), implying that a 1pp increase in renewables is associated with an average reduction of around 6.23 gCO₂/kWh in carbon intensity. As expected for year-to-year variation, explanatory power is lower (R² = 0.278), but the persistence of a negative association in changes reduces concern that the levels result is purely an artefact of common trending behaviour.

Mechanism analysis incorporating coal share is consistent with fuel-mix displacement playing an important role. Coal share is strongly positively associated with carbon intensity: a 10pp increase in coal share corresponds to roughly +53.3 gCO₂/kWh higher carbon intensity (0.10 × 533.191). Once coal share is included, the renewables coefficient shrinks markedly (β = −347.836), implying about −3.48 gCO₂/kWh for a 1pp increase (0.01 × 347.836), which is consistent with renewables operating partly through reduced coal generation (and potentially through broader system effects beyond coal displacement alone). The interaction extension reinforces this channel: coal share remains strongly positive (β = 577.90, p < 0.001) and Figure 4 shows a steeper predicted decline in carbon intensity with renewables when the system is more coal-intensive; overall fit is very high (R² = 0.996). The quadratic extension suggests a concave/flattening relationship at higher renewable shares (Figure 5; R² = 0.970), which is best interpreted as a functional-form diagnostic rather than a definitive structural claim given the short annual sample.

Finally, the residual diagnostics show that the model captures broad movements but leaves notable year-specific deviations. In Figure 6, the largest under-prediction occurs in 2012 (residual ≈ +35.2 gCO₂/kWh) and the largest over-prediction occurs in 2016 (residual ≈ −59.5 gCO₂/kWh), indicating that some years deviate materially from what the model predicts based only on renewable share and a linear trend. Figure 7 and the residual “segment” diagnostic (Appendix Figure 8) reinforce that while residuals are centred around zero overall, a small number of years contribute disproportionately to model error. These patterns support interpreting the regressions as descriptive associations that capture average relationships, rather than a complete model of all drivers of emissions intensity.

### Limitations

First, the analysis is descriptive and does not establish causality. Renewable share may be endogenous to conditions that also affect carbon intensity (e.g., weather, demand, fuel prices, outages, and policy). Without an identification strategy (e.g., an instrument or quasi-experimental design) and/or richer covariates capturing these factors, the coefficients should be interpreted as associations.

Second, the data are annual with a limited sample size. Annual aggregation can mask short-run operational dynamics and policy timing, limiting the ability to distinguish persistent structural change from transitory shocks. This also makes extensions (e.g., interactions and non-linearity) harder to estimate precisely and increases sensitivity to modelling choices.

Third, the time control is parsimonious (linear). If decarbonisation includes non-linear trends or structural breaks, a linear trend may not fully capture underlying change. Relatedly, the residual patterns and outlying years (Figures 6–7 and Appendix Figure 8) indicate omitted time-varying drivers remain important; future work could incorporate additional controls and apply time-series-robust inference (e.g., accounting for serial correlation) to strengthen reliability

## Conclusion

Across specifications, renewable electricity share is consistently negatively associated with the carbon intensity of UK electricity generation. The baseline levels estimate implies about −8.13 gCO₂/kWh per 1pp increase in renewable share (R² = 0.954), the association remains strongly negative with a time trend (about −10.80 gCO₂/kWh per 1pp; R² = 0.964), and it persists in year-to-year changes (about −6.23 gCO₂/kWh per 1pp; p = 0.008). Mechanism results are consistent with coal displacement being an important channel (e.g., +53.3 gCO₂/kWh for a 10pp increase in coal share), while residual diagnostics highlight a small number of years—such as 2012 (+35.2) and 2016 (−59.5)—where additional unmodelled factors materially affect carbon intensity. Overall, the evidence supports renewable expansion as a strong correlate of UK electricity decarbonisation over the period studied, but the estimates should be treated as descriptive rather than causal.

## References 

Ritchie, H., Roser, M. and Rosado, P. (2024) Electricity mix in the United Kingdom. Our World in Data. Available at: https://ourworldindata.org/grapher/electricity-mix-uk (Accessed: 11 January 2026).

Ritchie, H., Roser, M. and Rosado, P. (2024) Carbon intensity of electricity generation. Our World in Data. Available at: https://ourworldindata.org/grapher/carbon-intensity-electricity (Accessed: 11 January 2026).



## Appendix



### Appendix A: Reproducibility

The main document selectively displays code to conserve the word count. The full workflow remains reproducible from this R Markdown file together with the input datasets. Package versions are reported below.

```{r residual-segments}
ggplot(analysis_data_clean, aes(x = renewable_share, y = carbon_intensity)) +
  geom_point(color = "black") +
  geom_smooth(method = "lm", se = FALSE, color = "blue") +
  geom_segment(
    aes(
      xend = renewable_share,
      yend = predicted_carbon
    ),
    color = "red",
    alpha = 0.5
  ) +
  labs(
    title = "Renewable Share and Carbon Intensity with Residuals Plot",
    x = "Renewable share of electricity generation",
    y = "Carbon intensity (gCO₂/kWh)"
  ) +
  theme_minimal()

```


Appendix Figure 8 visualises residuals as vertical segments between observed carbon intensity and the fitted regression line. Larger segments highlight years where outcomes deviate most strongly from the fitted relationship at a given renewable share. This figure is included as an intuitive visual complement to the formal residual diagnostics in Figures 6-7

### Appendix B: Code listings (not executed)

The following chunks reproduce key data-processing and diagnostic steps. They are shown for transparency but are not re-run in the appendix.

```{r appendix-data-cleaning-code, echo=TRUE, eval=FALSE}
carbon_raw <- read_csv("carbon-intensity-electricity.csv")
electricity_raw <- read_csv("electricity-mix-uk.csv")

carbon_uk <- carbon_raw %>%
  filter(Entity == "United Kingdom") %>%
  select(
    year = Year,
    carbon_intensity = `Carbon intensity of electricity - gCO2/kWh`
  )

electricity_uk <- electricity_raw %>%
  filter(Entity == "United Kingdom") %>%
  select(
    year = Year,
    wind = `Electricity generation from wind`,
    solar = `Electricity generation from solar`,
    hydro = `Electricity generation from hydropower`,
    other_renewables = `Electricity generation from other renewables`,
    gas = `Electricity generation from gas`,
    coal = `Electricity generation from coal`,
    oil = `Electricity generation from oil`,
    nuclear = `Electricity generation from nuclear`,
    net_imports = `Net electricity imports`
  ) %>%
  mutate(
    renewable_generation = wind + solar + hydro + other_renewables,
    total_generation = renewable_generation + gas + coal + oil + nuclear + net_imports,
    renewable_share = renewable_generation / total_generation
  )

analysis_data_clean <- left_join(electricity_uk, carbon_uk, by = "year") %>%
  filter(!is.na(carbon_intensity)) %>%
  select(year, renewable_share, carbon_intensity)
```

```{r appendix-first-differences-code, echo=TRUE, eval=FALSE}
diff_data <- analysis_data_clean %>%
  arrange(year) %>%
  mutate(
    d_carbon = carbon_intensity - lag(carbon_intensity),
    d_renewable = renewable_share - lag(renewable_share)
  ) %>%
  filter(!is.na(d_carbon))

diff_model <- lm(d_carbon ~ d_renewable, data = diff_data)
```

```{r appendix-residuals-code, echo=TRUE, eval=FALSE}
analysis_data_clean <- analysis_data_clean %>%
  mutate(
    predicted_carbon = predict(levels_time_model),
    residual = carbon_intensity - predicted_carbon
  )

resid_summary <- analysis_data_clean %>%
  summarise(
    mean_resid = mean(residual, na.rm = TRUE),
    sd_resid   = sd(residual, na.rm = TRUE),
    p10 = quantile(residual, 0.10, na.rm = TRUE),
    p50 = quantile(residual, 0.50, na.rm = TRUE),
    p90 = quantile(residual, 0.90, na.rm = TRUE)
  )

resid_outliers <- analysis_data_clean %>%
  mutate(abs_resid = abs(residual)) %>%
  arrange(desc(abs_resid)) %>%
  slice_head(n = 5) %>%
  select(year, renewable_share, carbon_intensity, predicted_carbon, residual)

```



### Appendix C: Session information

```{r session-info, echo=FALSE}
sessionInfo()
```

